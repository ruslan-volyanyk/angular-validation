(function(){angular.module("validation",["validation.provider","validation.directive"]),angular.module("validation.provider",[]),angular.module("validation.directive",["validation.provider"])}).call(this),function(){function a(){var a,b,c,d,e,f=this,g=function(f){a=f,b=a.get("$rootScope"),c=a.get("$http"),d=a.get("$q"),e=a.get("$timeout")},h={},i=null,j={};this.focusedElements={},this.resetFocusedElements=function(a){for(var b in f.focusedElements)delete f.focusedElements[b];return f},this.setExpression=function(a){return angular.extend(h,a),f},this.getExpression=function(a){return h[a]},this.setDefaultMsg=function(a){return angular.extend(j,a),f},this.getDefaultMsg=function(a){return j[a]},this.setValidMethod=function(a){i=a},this.getValidMethod=function(){return i},this.setErrorHTML=function(a){return a.constructor===Function?(f.getErrorHTML=a,f):void 0},this.getErrorHTML=function(a){return'<p class="validation-invalid">'+a+"</p>"},this.setSuccessHTML=function(a){return a.constructor===Function?(f.getSuccessHTML=a,f):void 0},this.getSuccessHTML=function(a){return'<p class="validation-valid">'+a+"</p>"},this.showSuccessMessage=!0,this.showErrorMessage=!0,this.checkValid=function(a){return!(!a||!a.$valid)},this.checkFormAttributesValid=function(a,b){isInvalid=!1;for(var c in a)"$"!==c[0]&&-1!==$.inArray(c,b)&&a[c].$invalid&&(isInvalid=!0);return!isInvalid},this.validate=function(a,c){var g=d.defer(),h=0;if(void 0===a)return console.error("This is not a regular Form name scope"),g.reject("This is not a regular Form name scope"),g.promise;if(a.validationId)b.$broadcast(a.$name+"submit-"+a.validationId,h++);else if(a.constructor===Array)for(var i in a)b.$broadcast(a[i].$name+"submit-"+a[i].validationId,h++);else for(var j in a)"$"!==j[0]&&a[j].hasOwnProperty("$dirty")&&(broadcast_line=j+"submit-"+a[j].validationId,c&&(broadcast_line+=c),b.$broadcast(broadcast_line,h++));return g.promise.success=function(a){return g.promise.then(function(b){a(b)}),g.promise},g.promise.error=function(a){return g.promise.then(null,function(b){a(b)}),g.promise},e(function(){f.checkValid(a)?g.resolve("success"):g.reject("error")}),g.promise},this.validCallback=null,this.invalidCallback=null,this.resetCallback=null,this.reset=function(a){if(void 0===a)return void console.error("This is not a regular Form name scope");if(a.validationId)b.$broadcast(a.$name+"reset-"+a.validationId);else if(a.constructor===Array)for(var c in a)b.$broadcast(a[c].$name+"reset-"+a[c].validationId);else for(var d in a)"$"!==d[0]&&a[d].hasOwnProperty("$dirty")&&b.$broadcast(d+"reset-"+a[d].validationId)},this.addMsgElement=function(a){return a.after("<span></span>")},this.getMsgElement=function(a){return a.next()},this.$get=["$injector",function(a){return g(a),{setValidMethod:this.setValidMethod,getValidMethod:this.getValidMethod,setErrorHTML:this.setErrorHTML,getErrorHTML:this.getErrorHTML,setSuccessHTML:this.setSuccessHTML,getSuccessHTML:this.getSuccessHTML,setExpression:this.setExpression,getExpression:this.getExpression,setDefaultMsg:this.setDefaultMsg,getDefaultMsg:this.getDefaultMsg,showSuccessMessage:this.showSuccessMessage,showErrorMessage:this.showErrorMessage,checkValid:this.checkValid,checkFormAttributesValid:this.checkFormAttributesValid,validate:this.validate,validCallback:this.validCallback,invalidCallback:this.invalidCallback,resetCallback:this.resetCallback,reset:this.reset,addMsgElement:this.addMsgElement,getMsgElement:this.getMsgElement,focusedElements:this.focusedElements,resetFocusedElements:this.resetFocusedElements}}]}angular.module("validation.provider").provider("$validation",a)}.call(this),function(){function a(a){var b=a.get("$validation"),c=a.get("$timeout"),d=a.get("$parse");return{link:function(a,e,f){var g=d(f.validationReset)(a);c(function(){e.on("click",function(a){a.preventDefault(),b.reset(g)})})}}}angular.module("validation.directive").directive("validationReset",a),a.$inject=["$injector"]}.call(this),function(){function a(a){var b=a.get("$validation"),c=a.get("$timeout"),d=a.get("$parse");return{priority:1,require:"?ngClick",link:function(a,e,f){var g=d(f.validationSubmit)(a);c(function(){e.off("click"),e.on("click",function(c){c.preventDefault(),b.validate(g).success(function(){d(f.ngClick)(a)})})})}}}angular.module("validation.directive").directive("validationSubmit",a),a.$inject=["$injector"]}.call(this),function(){function a(a){var b=a.get("$validation"),c=a.get("$q"),d=a.get("$timeout"),e=a.get("$compile"),f=a.get("$parse"),g=function(a,c,d,g,h,i){var j,k=c||b.getDefaultMsg(d).success,l=f("success"),m=i.messageId,n=i.validationGroup;return j=m||n?angular.element(document.querySelector("#"+(m||n))):b.getMsgElement(a),a.attr("no-validation-message")?j.css("display","none"):b.showSuccessMessage&&k?(j.html("").append(e(b.getSuccessHTML(k,a,i))(g)),j.css("display","")):j.css("display","none"),h.$setValidity(h.$name,!0),l&&l({message:k}),b.validCallback&&b.validCallback(a),!0},h=function(a,c,d,g,h,i){var j,k=c||b.getDefaultMsg(d).error,l=f("error"),m=i.messageId,n=i.validationGroup;return j=m||n?angular.element(document.querySelector("#"+(m||n))):b.getMsgElement(a),a.attr("no-validation-message")?j.css("display","none"):b.showErrorMessage&&k?(j.html("").append(e(b.getErrorHTML(k,a,i))(g)),j.css("display","")):j.css("display","none"),h.$setValidity(h.$name,!1),l&&l({message:k}),b.invalidCallback&&b.invalidCallback(a),!1},i=function(a,b,c,d){var e,f=c.validationGroup,g=document.querySelectorAll("*[validation-group="+f+"]");d.$setValidity(d.$name,!1);for(var h=0,i=g.length;i>h;h++)if(e=angular.element(g[h]),e.hasClass("ng-valid")&&e[0]!==b[0])return!0;return!1},j=function(a,d,e,f,k,l,m){var n=k.slice(0),o=n[0].trim(),p=o.indexOf("="),q=-1===p?o:o.substr(0,p),r=-1===p?null:o.substr(p+1),s=n.slice(1),t=q+"SuccessMessage",u=q+"ErrorMessage",v=b.getExpression(q),w=e.validationGroup,x={success:function(){return m?f.$setValidity(f.$name,!0):g(d,e[t],q,a,f,e),s.length?j(a,d,e,f,s,l,m):!0},error:function(){return m?f.$setValidity(f.$name,!1):h(d,e[u],q,a,f,e)}};return void 0===v?(console.error('You are using undefined validator "%s"',q),s.length?j(a,d,e,f,s,l):void 0):v.constructor===Function?c.all([b.getExpression(q)(l,a,d,e,r)]).then(function(b){return b&&b.length>0&&b[0]?x.success():w?void(i(a,d,e,f)||x.error()):x.error()},function(){return x.error()}):v.constructor!==RegExp?x.error():void 0!==l&&null!==l?b.getExpression(q).test(l)?x.success():x.error():w?void(i(a,d,e,f)||x.error()):x.error()},k=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},l=function(){return k()+k()+k()+k()};return{restrict:"A",require:"ngModel",link:function(a,c,e,f){var g,h=e.validator,i=e.messageId,k=e.validationGroup,m=e.validMethod,n=e.ngModel,o=function(){},p=h.split(","),q=f.validationId=l();return"boolean"==typeof a.initialValidity&&(g=a.initialValidity),i||k||b.addMsgElement(c),f.$setValidity(f.$name,g),a.$on(f.$name+"reset-"+q,function(){o(),d(function(){f.$setViewValue(""),f.$setPristine(),f.$setValidity(f.$name,void 0),f.$render(),i||k?angular.element(document.querySelector("#"+(i||k))).html(""):b.getMsgElement(c).html(""),b.resetCallback&&b.resetCallback(c)})}),m=angular.isUndefined(m)?b.getValidMethod():m,a.$on(f.$name+"submit-"+q,function(g,h){var i=f.$viewValue,k=!1;k=j(a,c,e,f,p,i),"submit"===m&&(o(),o=a.$watch(function(){return a.$eval(n)},function(b,d){b!==d&&(void 0!==b&&null!==b||(b=""),k=j(a,c,e,f,p,b))}));var l=function(a){a?delete b.focusedElements[h]:(b.focusedElements[h]=c[0],d(function(){b.focusedElements[Math.min.apply(null,Object.keys(b.focusedElements))].focus()},0))};"Promise"===k.constructor.name?k.then(l):l(k)}),a.$on(f.$name+"submit-"+q+!0,function(g,h){var i=f.$viewValue,k=!1,l=!0;k=j(a,c,e,f,p,i,l),"submit"===m&&(o(),o=a.$watch(function(){return a.$eval(n)},function(b,d){b!==d&&(void 0!==b&&null!==b||(b=""),k=j(a,c,e,f,p,b))}));var q=function(a){a?delete b.focusedElements[h]:(b.focusedElements[h]=c[0],d(function(){b.focusedElements[Math.min.apply(null,Object.keys(b.focusedElements))].focus()},0))};"Promise"===k.constructor.name?k.then(q):q(k)}),"blur"===m?void c.bind("blur",function(){var b=a.$eval(n);a.$apply(function(){j(a,c,e,f,p,b)})}):void("submit"!==m&&"submit-only"!==m&&(a.$watch(n,function(b,d){b!==d&&j(a,c,e,f,p,b)},!0),d(function(){e.$observe("noValidationMessage",function(a){var d;d=i||k?angular.element(document.querySelector("#"+(i||k))):b.getMsgElement(c),"true"===a||a===!0?d.css("display","none"):"false"!==a&&a!==!1||d.css("display","block")})})))}}}angular.module("validation.directive").directive("validator",a),a.$inject=["$injector"]}.call(this);